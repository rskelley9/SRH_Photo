(function(g){g.fn.html5audio=function(f){function Pa(a){p=Math.max(0,Math.min(1,(a-ja.offset().left)/Q));ka()}function ka(){ob.css("width",p*Q+"px");k&&soundManager.setVolume(t,100*p);0<p?c.find(".player_volume").find("img").attr("src",Qa):c.find(".player_volume").find("img").attr("src",Ra)}function pb(){k&&(Y.css("display","block"),Z.bind("mousemove",Sa).bind("mouseout",la),E.bind("mouseout",la))}function la(){k&&(Y.css("display","none"),Z.unbind("mousemove",Sa).unbind("mouseout",la),E.unbind("mouseout", la))}function Sa(a){a=a.pageX-ja.offset().left;0>a?a=0:a>Q&&(a=Q);var b=a+parseInt(Z.css("left"),10)+parseInt(qb.css("left"),10)+parseInt(ja.css("left"),10)-Y.width()/2;Y.css("left",b+"px");a=Math.max(0,Math.min(1,a/Q));a=parseInt(100*a,10);Y.find("p").html(a+" %")}function Ta(a){M=a-Ua.offset().left;0>M?M=0:M>I&&(M=I);ma.width(M);a=Math.max(0,Math.min(1,M/I));soundManager.setPosition(t,a*rb())}function sb(){k&&($.css("display","block"),R.bind("mousemove",Va).bind("mouseout",na),E.bind("mouseout", na))}function na(){k&&($.css("display","none"),R.unbind("mousemove",Va).unbind("mouseout",na),E.unbind("mouseout",na))}function Va(a){a=a.pageX-R.offset().left;0>a?a=0:a>I&&(a=I);var b=a+parseInt(R.css("left"),10)-$.width()/2;$.css("left",b+"px");a=Math.max(0,Math.min(1,a/I));b=r.duration?parseInt(r.bytesLoaded/r.bytesTotal*(r.duration/1E3)):N?parseInt(r.bytesLoaded/r.bytesTotal*(N/1E3)):void 0;a*=b;isNaN(a)||$.find("p").html(xa(a)+tb+Wa(r.duration/1E3))}function ya(){x?(x.reinitialise(),x.scrollToY(0)): (x=O.jScrollPane().data().jsp,O.bind("jsp-initialised",function(){}).jScrollPane({verticalDragMinHeight:30,verticalDragMaxHeight:40}))}function Xa(a){m?(soundManager.pause(t),m=!1,a?c.find(".controls_toggle").find("img").attr("src",!G?za:H):c.find(".controls_toggle").find("img").attr("src",G?za:H)):(soundManager.play(t),m=!0,a?c.find(".controls_toggle").find("img").attr("src",!G?Aa:aa):c.find(".controls_toggle").find("img").attr("src",G?Aa:aa));return!1}function Ba(a){if(n&&!q)return a||(a=window.event), a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation(),a=g(a.currentTarget).attr("data-id"),J(),e.processPlaylistRequest(a),!1}function J(){if(-1!=e.getCounter()){var a=g(z[e.getCounter()]);a&&a.removeClass("playlistSelected").addClass("playlistNonSelected")}}function Ya(){var a=g(z[e.getCounter()]);a&&a.removeClass("playlistNonSelected").addClass("playlistSelected")}function ub(a){if(n&&!q){a||(a=window.event);a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation(); a=g(a.currentTarget).attr("class");if("controls_prev"==a){if(!k)return;J();e.advanceHandler(-1,!0)}else if("controls_toggle"==a){if(!k)return;Xa(!0)}else if("controls_next"==a){if(!k)return;J();e.advanceHandler(1,!0)}else if("player_volume"==a){if(Ca)return!1;oa?(p=Za,oa=!1):(Za=p,p=0,oa=!0);ka()}else"player_loop"==a?(A?(c.find(".player_loop").find("img").attr("src",pa),A=!1):(c.find(".player_loop").find("img").attr("src",ba),A=!0),e.setLooping(A)):"player_shuffle"==a&&(B?(c.find(".player_shuffle").find("img").attr("src", qa),B=!1):(c.find(".player_shuffle").find("img").attr("src",ca),B=!0),e.setRandom(B));return!1}}function vb(a){if(n)return a||(a=window.event),a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation(),a=g(a.currentTarget).attr("class"),"controls_prev"==a?c.find(".controls_prev").find("img").attr("src",wb):"controls_toggle"==a?m?c.find(".controls_toggle").find("img").attr("src",Aa):c.find(".controls_toggle").find("img").attr("src",za):"controls_next"==a?c.find(".controls_next").find("img").attr("src", xb):"player_volume"==a?0<p?c.find(".player_volume").find("img").attr("src",yb):c.find(".player_volume").find("img").attr("src",zb):"player_loop"==a?A?c.find(".player_loop").find("img").attr("src",pa):c.find(".player_loop").find("img").attr("src",ba):"player_shuffle"==a&&(B?c.find(".player_shuffle").find("img").attr("src",qa):c.find(".player_shuffle").find("img").attr("src",ca)),!1}function Ab(a){if(n)return a||(a=window.event),a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation(), a=g(a.currentTarget).attr("class"),"controls_prev"==a?c.find(".controls_prev").find("img").attr("src",Bb):"controls_toggle"==a?m?c.find(".controls_toggle").find("img").attr("src",aa):c.find(".controls_toggle").find("img").attr("src",H):"controls_next"==a?c.find(".controls_next").find("img").attr("src",Cb):"player_volume"==a?0<p?c.find(".player_volume").find("img").attr("src",Qa):c.find(".player_volume").find("img").attr("src",Ra):"player_loop"==a?A?c.find(".player_loop").find("img").attr("src",ba): c.find(".player_loop").find("img").attr("src",pa):"player_shuffle"==a&&(B?c.find(".player_shuffle").find("img").attr("src",ca):c.find(".player_shuffle").find("img").attr("src",qa)),!1}function $a(){h&&-1!=e.getCounter()&&(Da(),ab(),c.find(".controls_toggle").find("img").attr("src",H),J())}function da(){Da();ab();var a=0;for(a;a<s;a++)g(z[a]).unbind("click",Ba);"hidden"!=h&&h.remove();h=null;e.reSetCounter();u=[];z=[];C=[];G&&(S=!1);x&&x.reinitialise()}function bb(a){cb();O.css("opacity",0);h&&da(); var b=Db.find(a).css("display","block").clone();x?b.appendTo(x.getContentPane()):b.appendTo(O);0==b.length?j&&alert('Failed to select playlist! Make sure that element: "'+a+'" exist in playlist list! Quitting.'):(h=b,u=[],z=[],C=[],D=[],b.find("li[class='playlistItem']").each(function(){_item=g(this);D.push(_item)}),P())}function P(){if(D.length){var a=D[0],b=a.attr("data-type").toLowerCase(),d=a.attr("data-path");v=[];if("local"==b)C.push(a),z.push(a.find("a[class='playlistNonSelected']")),D.shift(), P();else if("soundcloud"==b)a.remove(),Ea(d);else if("podcast"==b)a.remove(),b="http://ajax.googleapis.com/ajax/services/feed/load?v=1.0&output=xml&num=10&callback=?&q="+encodeURIComponent(d),g.ajax({type:"GET",url:b,dataType:"jsonp",cache:!1,success:function(a){if(db){a=a.responseData.xmlString;if(window.ActiveXObject&&window.GetObject){var b=new ActiveXObject("Microsoft.XMLDOM");b.loadXML(a);a=b}else if(window.DOMParser)a=(new DOMParser).parseFromString(a,"text/xml");else throw Error("No XML parser available"); var d;g(a).find("item").each(function(){d=g(this);e={type:"podcast"};e.mp3=d.find("enclosure").attr("url");e.ogg="";e.title=d.find("title").text();v.push(e)})}else{eb.html(a.responseData.xmlString);a=eb.get(0).getElementsByTagName("item");var b=0,c=a.length,f,F,e;for(b;b<c;b++){f=a[b];e={type:"podcast"};e.mp3=f.getElementsByTagName("enclosure")[0].getAttribute("url");e.ogg="";if(void 0!=f.getElementsByTagName("itunes:duration")[0]){F=f.getElementsByTagName("itunes:duration")[0].childNodes[0].nodeValue.split(":"); for(var h=0,j=1;0<F.length;)h+=j*parseInt(F.pop()),j*=60;F=h;e.length=parseInt(1E3*F,10)}e.title=f.getElementsByTagName("title")[0].childNodes[0].nodeValue;v.push(e)}}ea()},error:function(a,b){j&&alert("Parse feed error: "+b);j&&alert("Playlist selection failed: "+d);D.shift();P()}});else if("folder"==b)a.remove(),jQuery.getJSON("folder_parser.php","folderUrl="+d,function(a){var b=0,d=a.length,c,e;for(b;b<d;b++)c=a[b],c.indexOf("\\")&&(c=c.replace(/\\/g,"/")),e={type:"local"},c.indexOf(".mp3")&&(e.mp3= c),e.ogg=c.substr(0,c.lastIndexOf("."))+".ogg",no_ext=c.substr(0,c.lastIndexOf(".")),c=no_ext.indexOf("/")?no_ext.substr(no_ext.lastIndexOf("/")+1):no_ext,c=c.split("_").join(" "),e.title=c,v.push(e);ea()}).error(function(){j&&alert("Read folder error! Make sure you run this online or on local server!");j&&alert("Playlist selection failed: "+d);D.shift();P()});else if("xml"==b){Fa=a;a.css("display","none");var c,F,f,h,w,l;g.ajax({type:"GET",url:d,dataType:"html",cache:!1,success:function(b){g(b).find("li[class='playlistItem']").each(function(){l= g(this);w=l.attr("data-type");c=g("<div>").append(l.clone()).html();"local"==w?(F=document.createElement("ul"),F.innerHTML=c,f=F.firstChild,h=F.firstChild.firstChild,Fa.after(g(f)),Fa=g(f),C.push(g(f)),z.push(g(h))):"xml"==w?j&&alert("You cannot load xml over xml, this feature is not supported. Skipping processing of playlist: "+c):D.push(l)});a.remove();D.shift();P()},error:function(){j&&alert("Parse xml error! Make sure you run this online or on local server!");j&&alert("Playlist selection failed: "+ d);D.shift();P()}})}else j&&alert("Invalid playlist data-type attribute!")}else{s=C.length;var b=0,y,p,k,r,m,x;for(b;b<s;b++)y=g(z[b]).bind("click",Ba).attr("data-id",b),p=y.html(),Ga&&(k=ra(b)+". "+p,y.html(k)),y=g(C[b]),k=x=m="",r=void 0,void 0!=y.attr("data-mp3Path")&&(m=y.attr("data-mp3Path")),void 0!=y.attr("data-oggPath")&&(x=y.attr("data-oggPath")),void 0!=y.attr("data-type")&&(k=y.attr("data-type")),void 0!=y.attr("data-length")&&(r=y.attr("data-length")),u.push({id:b,type:k,title:p,mp3Path:m, oggPath:x,length:r});O.css("opacity",1);Ha&&ya();n||(n=!0,"undefined"!==typeof audioPlayerSetupDone&&audioPlayerSetupDone(t));0==s?(j&&alert("Processing playlist failed. Quitting."),q=!1,sa()):(q=!1,sa(),e.setPlaylistItems(s),Ia(),"undefined"!==typeof audioPlayerPlaylistLoaded&&audioPlayerPlaylistLoaded(t))}}function ea(){if(v.length){var a,b,d=0,c=v.length;for(d;d<c;d++)a=g('<li class= "playlistItem" data-type="'+v[d].type+'" data-mp3Path="'+v[d].mp3+'" data-oggPath="'+v[d].ogg+'"></li>').addClass("playlistItem").appendTo(h), v[d].length&&a.attr("data-length",v[d].length),b=g('<a class="playlistNonSelected" href="#">'+v[d].title+"</a>").addClass("playlistNonSelected").appendTo(a),C.push(a),z.push(b)}D.shift();P()}function Ja(a){var b,d,c=z.length?!1:!0;for(a;a<s;a++)c||(b=g(z[a]).attr("data-id",a),Ga&&(d=b.html(),d=d.substr(d.indexOf(".")+2),u[a].title=d,d=ra(a)+". "+d,b.html(d))),u[a].id=a}function Ia(){var a=f.activeItem;-1!=a?(0>a?a=0:a>s-1&&(a=s-1),e.setCounter(a,!1)):S=!0}function Ea(a){g.getJSON((/api\./.test(a)? a+"?":"http://api.soundcloud.com/resolve?url="+a+"&")+"format=json&consumer_key="+ta+"&callback=?",function(b){var d,c,e;if(b.tracks){c=b.tracks.length;for(e=0;e<c;e++)d={type:"soundcloud"},b.tracks[e].duration&&(d.length=b.tracks[e].duration),d.thumbUrl=b.tracks[e].artwork_url?b.tracks[e].artwork_url:"",d.mp3=b.tracks[e].stream_url+(/\?/.test(b.tracks[e].stream_url)?"&":"?")+"consumer_key="+ta,d.ogg="",d.title=b.tracks[e].title,v.push(d);ea()}else if(b.duration)b.permalink_url=a,d={type:"soundcloud"}, b.duration&&(d.length=b.duration),d.thumbUrl=b.artwork_url?b.artwork_url:"",d.mp3=b.stream_url+(/\?/.test(b.stream_url)?"&":"?")+"consumer_key="+ta,d.ogg="",d.title=b.title,v.push(d),ea();else if(b.username)/favorites/.test(a)?Ea(b.uri+"/favorites"):Ea(b.uri+"/tracks");else if(g.isArray(b)){c=b.length;for(e=0;e<c;e++)d={type:"soundcloud"},b[e].duration&&(d.length=b[e].duration),d.thumbUrl=b[e].artwork_url?b[e].artwork_url:"",d.mp3=b[e].stream_url+(/\?/.test(b[e].stream_url)?"&":"?")+"consumer_key="+ ta,d.ogg="",d.title=b[e].title,v.push(d);ea()}}).error(function(){j&&alert("SoundCloud process error!");q=!1})}function Da(){r&&(soundManager.destroySound(t),r=null);Ka();La=k=m=ua=!1}function Eb(){var a=this.bytesLoaded/this.bytesTotal;isNaN(a)||Ma.width(a*I)}function Fb(){var a=this.position/1E3,b;this.duration?b=this.duration/1E3:N&&(b=N/1E3);isNaN(a)||fa.html(xa(a)+fb);!isNaN(a)&&!isNaN(b)?(fa.html(xa(a)+fb),va.html(Wa(b)),T||ma.width(a/b*I),ua=!1):ua=!0}function Gb(){}function rb(){if(r.duration)return parseInt(r.bytesLoaded/ r.bytesTotal*r.duration);if(N)return parseInt(r.bytesLoaded/r.bytesTotal*N)}function Hb(){"undefined"!==typeof audioPlayerSoundEnd&&audioPlayerSoundEnd(e.getCounter());J();e.advanceHandler(1,!0)}function Ib(){}function Jb(){La||("undefined"!==typeof audioPlayerSoundStart&&audioPlayerSoundStart(e.getCounter()),La=!0);"undefined"!==typeof audioPlayerSoundPlay&&audioPlayerSoundPlay(t)}function Kb(){"undefined"!==typeof audioPlayerSoundPlay&&audioPlayerSoundPlay(t)}function Lb(){"undefined"!==typeof audioPlayerSoundPause&& audioPlayerSoundPause(t)}function sa(){gb.css("display","none")}function cb(){gb.css("display","block")}function ab(){l&&ga&&l.deactivate();K.html(Na);fa.html(hb);va.html(ib);ma.width(0);Ma.width(0);c.find(".controls_toggle").find("img").attr("src",H)}function Ka(){jb||(l&&l.deactivate(),K.html(Na));fa.html(hb);va.html(ib);ma.width(0);Ma.width(0);c.find(".controls_toggle").find("img").attr("src",H)}function xa(a){a=Math.round(a);minutes=Math.floor(a/60);minutes=10<=minutes?minutes:"0"+minutes;a=Math.floor(a% 60);return minutes+":"+(10<=a?a:"0"+a)}function Wa(a){a=Math.round(a);minutes=Math.floor(a/60);minutes=10<=minutes?minutes:"0"+minutes;a=Math.floor(a%60);return minutes+":"+(10<=a?a:"0"+a)}function U(a){return 0==u[a].title.replace(/^\s+|\s+$/g,"").length?(K.html(Na),!1):ra(u[a].id)+". "+u[a].title}function ra(a){return 9>a?"0"+(a+1):a+1}var n=!1;g("body");g(window);var E=g(document),G=/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent),Ca=!1,V=navigator.userAgent;if(-1<V.indexOf("iPhone")|| -1<V.indexOf("iPod")||-1<V.indexOf("iPad"))Ca=!0,-1<V.indexOf("iPhone")||-1<V.indexOf("iPod")||V.indexOf("iPad");var db=!1,Oa,kb=-1;"Microsoft Internet Explorer"==navigator.appName&&null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(kb=parseFloat(RegExp.$1));Oa=kb;-1!=Oa&&9>Oa&&(db=!0);var ha=document.createElement("audio");ha.canPlayType&&(ha.canPlayType&&ha.canPlayType("audio/mpeg"),ha.canPlayType&&ha.canPlayType('audio/ogg; codecs="vorbis"'));var c=g(f.playerHolder);c.find(".componentPlaylist"); var O=c.find(".playlist_inner").css("opacity",0);c.find(".playlistHolder");c.find(".playerHolder");c.find(".player_mediaTime");var fa=c.find(".player_mediaTime_current"),va=c.find(".player_mediaTime_total"),Mb=c.find(".player_mediaName_Mask"),K=c.find(".player_mediaName"),qb=c.find(".player_controls"),gb=c.find(".preloader"),Bb=f.buttonsUrl.prev,wb=f.buttonsUrl.prevOn,Cb=f.buttonsUrl.next,xb=f.buttonsUrl.nextOn,H=f.buttonsUrl.play,za=f.buttonsUrl.playOn,aa=f.buttonsUrl.pause,Aa=f.buttonsUrl.pauseOn, pa=f.buttonsUrl.loop,ba=f.buttonsUrl.loopOn,Qa=f.buttonsUrl.volume,yb=f.buttonsUrl.volumeOn,Ra=f.buttonsUrl.mute,zb=f.buttonsUrl.muteOn,qa=f.buttonsUrl.shuffle,ca=f.buttonsUrl.shuffleOn,Db=g(f.playlistHolder),t=f.sound_id,S=f.autoPlay,Nb=f.autoLoad;G&&(S=!1);var ta=f.soundcloudApiKey,ga=f.useSongNameScroll,jb=f.autoSetSongTitle,A=f.loopingOn,B=f.randomPlay,fb=f.mediaTimeSeparator,tb=f.seekTooltipSeparator,Ga=f.useNumbersInPlaylist,lb=f.activePlaylist,j=f.useAlertMessaging,Ha=f.ativatePlaylistScroll, Fa,h=null,q=!0,ua=!1,La=!1,r,Na=K.html(),hb=fa.html(),ib=va.html(),k=!1,mb="",nb="",m=!1,N;A&&c.find(".player_loop").find("img").attr("src",ba);B&&c.find(".player_shuffle").find("img").attr("src",ca);var u=[],z=[],C=[],s,x,eb=g("<div/>").css("display","none").appendTo(c),v=[],D=[],l;if(ga){var Ob=g("<div/>").addClass("fontMeasure").appendTo(c);l=new apTextScroller;l.init(Ob,K,Mb,"left",f.scrollSeparator,f.scrollSpeed)}var e=g.playlistManager({randomPlay:B,loopingOn:A});g(e).bind("ap_PlaylistManager.COUNTER_READY", function(){var a=e.getCounter();Ya();jb&&(l&&ga?(l.deactivate(),U(a)&&(l.input(U(a)),l.activate())):U(a)&&K.html(U(a)));mb=u[a].mp3Path;nb=u[a].oggPath;N=u[a].length?u[a].length:null;Da();r=soundManager.createSound({id:t,url:[mb,nb],autoLoad:Nb,autoPlay:S,volume:100*p,whileloading:Eb,whileplaying:Fb,onfinish:Hb,onload:Ib,onsuspend:Gb,onplay:Jb,onpause:Lb,onresume:Kb});S?(m=!0,c.find(".controls_toggle").find("img").attr("src",aa)):(m=!1,c.find(".controls_toggle").find("img").attr("src",H));ka();S= k=!0;"undefined"!==typeof itemTriggered&&itemTriggered(a)});g(e).bind("ap_PlaylistManager.PLAYLIST_END",function(){Ya();"undefined"!==typeof audioPlayerPlaylistEnd&&audioPlayerPlaylistEnd(t)});g(e).bind("ap_PlaylistManager.PLAYLIST_END_ALERT",function(){"undefined"!==typeof audioPlayerPlaylistEnd&&audioPlayerPlaylistEnd(t)});var wa="",W="",X="",L;"ontouchstart"in window?(L=!0,wa="touchstart.ap",W="touchmove.ap",X="touchend.ap"):(L=!1,wa="mousedown.ap",W="mousemove.ap",X="mouseup.ap");var Za,oa=!1, p=f.defaultVolume;0>p?p=0:1<p&&(p=1);var ia=!1,ja=c.find(".volume_bg"),Q=ja.width(),ob=c.find(".volume_level").css("width",p*Q+"px"),Z=c.find(".volume_seekbar").css("cursor","pointer").bind(wa,function(a){if(Ca)return!1;a:if(n&&!q&&!T&&!ia){if(L){if(a=a.originalEvent.touches,!(a&&0<a.length))break a}else a.preventDefault();ia=!0;E.bind(W,function(a){a:{var d;if(L){if(a.originalEvent.touches&&a.originalEvent.touches.length)d=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)d= a.originalEvent.changedTouches;else break a;if(1<d.length)break a;d=d[0]}else d=a;a.preventDefault();Pa(d.pageX)}});E.bind(X,function(a){a:if(ia){ia=!1;E.unbind(W).unbind(X);var d;if(L){if(a.originalEvent.touches&&a.originalEvent.touches.length)d=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)d=a.originalEvent.changedTouches;else break a;if(1<d.length)break a;d=d[0]}else d=a;a.preventDefault();Pa(d.pageX)}})}return oa=!1});if(!G){Z.bind("mouseover", pb);var Y=c.find(".player_volume_tooltip").css("left",parseInt(Z.css("left"),10)+"px")}var M,T=!1,Ua=c.find(".progress_bg"),Ma=c.find(".load_progress"),ma=c.find(".play_progress"),I=Ua.width(),R=c.find(".player_progress").css("cursor","pointer").bind(wa,function(a){a:if(n&&(k&&!ia&&!ua)&&!T){if(L){if(a=a.originalEvent.touches,!(a&&0<a.length))break a}else a.preventDefault();T=!0;E.bind(W,function(a){a:{var d;if(L){if(a.originalEvent.touches&&a.originalEvent.touches.length)d=a.originalEvent.touches; else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)d=a.originalEvent.changedTouches;else break a;if(1<d.length)break a;d=d[0]}else d=a;a.preventDefault();Ta(d.pageX)}});E.bind(X,function(a){a:if(T){T=!1;E.unbind(W).unbind(X);var d;if(L){if(a.originalEvent.touches&&a.originalEvent.touches.length)d=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)d=a.originalEvent.changedTouches;else break a;if(1<d.length)break a;d=d[0]}else d= a;a.preventDefault();Ta(d.pageX)}})}return!1});if(!G){R.bind("mouseover",sb);var $=c.find(".player_progress_tooltip").css("left",parseInt(R.css("left"),10)+"px")}soundManager.onready(function(){var a=[c.find(".controls_next"),c.find(".controls_prev"),c.find(".controls_toggle"),c.find(".player_volume"),c.find(".player_loop"),c.find(".player_shuffle")],b,d=a.length,e=0;for(e;e<d;e++)b=g(a[e]).css("cursor","pointer").bind("click",ub),!G&&b.bind("mouseover",vb).bind("mouseout",Ab);0==lb.replace(/^\s+|\s+$/g, "").length?n||(q=!1,n=!0,"undefined"!==typeof audioPlayerSetupDone&&audioPlayerSetupDone(t),sa()):bb(lb)});soundManager.ontimeout(function(a){j&&j&&(alert("SM2 failed to start. Flash missing, blocked or security error? Status: "+a.error.type),alert("SM2 could be trying to use flash. Make sure you test this ONLINE or ON LOCAL SERVER!"))});this.playAudio=function(){if(!n||q||!h||m||!k)return!1;soundManager.play(t);c.find(".controls_toggle").find("img").attr("src",aa);k=m=!0};this.pauseAudio=function(){if(!n|| q||!h||!m||!k)return!1;soundManager.pause(t);c.find(".controls_toggle").find("img").attr("src",H);m=!1};this.toggleAudio=function(){if(!n||q||!h||!k)return!1;Xa()};this.stopAudio=function(){if(!n||q||!h||!k)return!1;soundManager.stop(t);Ka();m=!1};this.nextAudio=function(){if(!n||q||!h)return!1;J();e.advanceHandler(1,!0)};this.previousAudio=function(){if(!n||q||!h)return!1;J();e.advanceHandler(-1,!0)};this.loadAudio=function(a){if(!n||q||!h)return!1;if("string"===typeof a){var b=0,d=!1;for(b;b<s;b++)if(a== u[b].title){a=b;d=!0;break}if(!d)return j&&alert('Track with name "'+a+'" doesnt exist. Load audio failed.'),!1}else if("number"===typeof a){if(0>a||a>s-1)return j&&alert('Invalid track number. Track number "'+a+'" doesnt exist. Load audio failed.'),!1}else return j&&alert("Load audio method requires either a track number or a track title to load. Load audio failed."),!1;J();e.processPlaylistRequest(a)};this.loadPlaylist=function(a){if(!n||q)return!1;if("undefined"===typeof a)return j&&alert("loadPlaylist method requires playlist parameter. loadPlaylist failed."), !1;q=!0;bb(a)};this.addTrack=function(a,b){if(!n||q)return!1;if("undefined"===typeof a)return j&&alert("addTrack method requires track parameter. AddTrack failed."),!1;var d=1;if("string"!==typeof a)if(a instanceof Array)d=a.length;else return j&&alert("addTrack method requires track as string or array parameter. AddTrack failed."),!1;h&&"hidden"==h&&da();var c=0,f,k,l,w,p,y,r,m,t=0;if(h)if("undefined"!==typeof b){if(0>b||b>s-1)return j&&alert('Invalid position to insert track to. Position number "'+ b+'" doesnt exist. AddTrack failed.'),!1}else p=!0,b=s-1;else{if("undefined"!==typeof b){if(0!=b)return j&&alert('Invalid position to insert track to. Position number "'+b+'" doesnt exist. AddTrack failed.'),!1}else b=0;p=!0;cb();r="playlist"+Math.floor(9999*Math.random());var v=g("<ul id = "+r+"></ul>");x?v.appendTo(x.getContentPane()):v.appendTo(O)}r=b;for(c;c<d;c++)f=document.createElement("ul"),m=1<d?a[c]:a,f.innerHTML=m,l=f.firstChild,f=f.firstChild.firstChild,w=g(l),l=g(f),void 0!=w.attr("data-type")&& "local"!=w.attr("data-type")?j&&alert('addTrack method supports local type tracks only. addTrack "'+m+'" failed.'):void 0!=w.attr("data-mp3Path")?(f=w.attr("data-mp3Path"),k="",void 0!=w.attr("data-oggPath")&&(k=w.attr("data-oggPath")),h?p?C[b].after(w):C[b].before(w):v.append(w),m=p?b+1:b,C.splice(m,0,w),z.splice(m,0,l),l.bind("click",Ba),w=l.html(),Ga&&(y=ra(b)+". "+w,l.html(y)),l={id:b,type:"local",title:w,mp3Path:f,oggPath:k,length:void 0},u.splice(m,0,l),1<d&&(b+=1),t++):j&&alert('addTrack method requires "data-mp3Path" attributte. addTrack "'+ m+'" failed.');s=u.length;Ja(0);d=e.getCounter();e.setPlaylistItems(s,!1);r<=d&&(p||e.reSetCounter(d+t));sa();O.css("opacity",1);Ha&&ya();h||(h=v,Ia())};this.inputAudio=function(a,b){if(!n||q)return!1;if("undefined"===typeof a)return j&&alert("inputAudio method requires track parameter. inputAudio failed."),!1;var d=1;if(!(a instanceof Object)||a instanceof Array)if(a instanceof Object&&a instanceof Array)d=a.length;else return j&&alert("inputAudio method requires track as object or array parameter. inputAudio failed."), !1;h&&"hidden"!=h&&da();var c=0,f,g,l,m,p,k,r=0;if(h)if("undefined"!==typeof b){if(0>b||b>s-1)return j&&alert('Invalid position to insert track to. Position number "'+b+'" doesnt exist. inputAudio failed.'),!1}else m=!0,b=s-1;else{if("undefined"!==typeof b){if(0!=b)return j&&alert('Invalid position to insert track to. Position number "'+b+'" doesnt exist. AddTrack failed.'),!1}else b=0;m=!0;s=0}p=b;for(c;c<d;c++)k=1<d?a[c]:a,k.mp3?(f=k.mp3,g="",k.ogg&&(g=k.ogg),l="",k.title&&(l=k.title),k=m?b+1:b, f={id:b,type:"local_hidden",title:l,mp3Path:f,oggPath:g,length:void 0},u.splice(k,0,f),1<d&&(b+=1),r++):j&&alert('inputAudio method requires mp3 parameter. inputAudio "'+k+'" failed.');s=u.length;Ja(0);d=e.getCounter();e.setPlaylistItems(s,!1);p<=d&&(m||e.reSetCounter(d+r));q=!1;h||(h="hidden",Ia())};this.removeTrack=function(a){if(!n||q||!h)return!1;if("string"===typeof a){var b=0,c=!1;for(b;b<s;b++)if(a==u[b].title){a=b;c=!0;break}if(!c)return j&&alert('Track with name "'+a+'" doesnt exist. RemoveTrack failed.'), !1}else if("number"===typeof a){if(0>a||a>s-1)return j&&alert('Invalid track number. Track number "'+a+'" doesnt exist. RemoveTrack failed.'),!1}else return j&&alert("RemoveTrack method requires either a track number or a track title to remove. RemoveTrack failed."),!1;"hidden"!=h&&(C[a].remove(),C.splice(a,1),z.splice(a,1));u.splice(a,1);s=u.length;0<s?(Ja(0),b=e.getCounter(),a==b?($a(),e.setPlaylistItems(s)):(e.setPlaylistItems(s,!1),a<b&&e.reSetCounter(e.getCounter()-1)),"hidden"!=h&&Ha&&ya()): da()};this.destroyAudio=function(){if(!n||q||!h)return!1;$a()};this.destroyPlaylist=function(){if(!n||q||!h)return!1;da()};this.setTitle=function(a){if(!n||q||!h)return!1;l&&ga?(l.deactivate(),l.input(a),l.activate()):K&&K.html(a)};this.checkAudio=function(a){if(!n||q||!h)return!1;m&&("pause"==a?soundManager.pause(t):"stop"==a&&(soundManager.stop(t),Ka()),m=!1,c.find(".controls_toggle").find("img").attr("src",H))};this.toggleShuffle=function(){if(!n)return!1;B?(c.find(".player_shuffle").find("img").attr("src", qa),B=!1):(c.find(".player_shuffle").find("img").attr("src",ca),B=!0);e.setRandom(B)};this.toggleLoop=function(){if(!n)return!1;A?(c.find(".player_loop").find("img").attr("src",pa),A=!1):(c.find(".player_loop").find("img").attr("src",ba),A=!0);e.setLooping(A)};this.setVolume=function(a){if(!n||q)return!1;0>a?a=0:1<a&&(a=1);p=a;ka()};this.getMediaPlaying=function(){return!n||q?!1:m};this.reinitPlaylistScroll=function(){if(!n||q||!h)return!1;x&&(x.reinitialise(),x.scrollToY(0))};this.reinitNameScroll= function(){if(!n||q||!h)return!1;if(l&&ga&&e&&-1!=e.getCounter()){var a=e.getCounter();U(a)&&(l.input(U(a)),l.activate())}};this.outputPlaylistData=function(){if(!n||q)return!1;if(h)try{console.log(u)}catch(a){}};return this}})(jQuery);